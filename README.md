# –ü–∞—Ä—Å–µ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ª–æ–≥–æ–≤ —Å–∏—Å—Ç–µ–º—ã –ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–ü–ª—é—Å

–ü—Ä–æ–µ–∫—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –ª–æ–≥–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å–µ—Å—Å–∏–π —Å–∏—Å—Ç–µ–º—ã –ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–ü–ª—é—Å

## üìå –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- **–ü–∞—Ä—Å–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π**:
  - `QS` - –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –¥–∞—Ç–∞, —Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å, ID –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–∏—Å–∫–∞
  - `DOC_OPEN` —Å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ–º ID, –¥–∞—Ç—ã –∏ –∫–æ–¥–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
  - `CARD_SEARCH_START` & `CARD_SEARCH_END` - —Å–æ–±—ã—Ç–∏—è –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è, –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –¥–∞—Ç–∞, —Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞, ID –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–∏—Å–∫–∞
- **–ö–æ—Ä—Ä–µ–∫—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**:
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö ID –≤ —Å–æ–±—ã—Ç–∏—è—Ö
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 8 —Ñ–æ—Ä–º–∞—Ç–æ–≤ –¥–∞—Ç (–º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å)
  - –∑–∞–ø–∏—Å—å –≤ –ª–æ–≥ –æ—à–∏–±–æ–∫ —Å–æ–±—ã—Ç–∏–π `DOC_OPEN` —Å –ø—É—Å—Ç–æ–π –¥–∞—Ç–æ–π
- **–ê–Ω–∞–ª–∏–∑**:
  - –ü–æ–¥—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–∞–∑, –∫–æ–≥–¥–∞ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–ª–∏ –ø–æ–∏—Å–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º ACC_45616
  - –ü–æ–¥—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –æ—Ç–∫—Ä—ã—Ç–∏–π –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ –¥–Ω—è–º
  - –ê–≥—Ä–µ–≥–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ –¥–Ω—è–º

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

```scala
Apache Spark 3.1.1     // –û–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö
Scala 2.12.10          // –Ø–¥—Ä–æ –ø–∞—Ä—Å–µ—Ä–æ–≤
Apache Maven 3.9.0     // –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
```

## üìä –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

```
Total lines loaded: 175630
Total successfully parsed QS events: 16111
Total successfully parsed CS events: 4059

Number of searches for document ACC_45616 by card: 444

Total DOC_OPEN events: 102872
Successfully parsed: 96306
Failed to parse: 6566
Total number of DOC_OPEN through QS: 77118
Documents with empty date: 6566
```

-**–ü–æ–¥—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–∞–∑, –∫–æ–≥–¥–∞ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–ª–∏ –ø–æ–∏—Å–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º ACC_45616**
  - –í—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å
  - –†–µ–∑—É–ª—å—Ç–∞—Ç: **444**


-**–ü–æ–¥—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –æ—Ç–∫—Ä—ã—Ç–∏–π –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ –¥–Ω—è–º**
  - –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–¥—Å—Ç—É–ø–µ–Ω –≤ —Ñ–∞–π–ª–µ doc_open_stat
    
```
2020-12-26,DOC_OPEN,RLAW411_173686,1
2020-12-26,DOC_OPEN,RLAW411_147657,2
2020-12-26,DOC_OPEN,RLAW411_139072,1
2020-12-26,DOC_OPEN,RLAW411_131280,1
2020-12-26,DOC_OPEN,RLAW411_121675,1
...
```
-**–ê–≥—Ä–µ–≥–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ –¥–Ω—è–º**
  - –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –≤ —Ñ–∞–π–ª–µ doc_open_aggregated
  
```
DOC_OPEN,ACC_45616,1083,01.03.2020,01.04.2020, ...
DOC_OPEN,ACC_45614,1011,01.01.2020,01.03.2020, ...
DOC_OPEN,CMB_18765,100,01.01.2020,01.09.2020, ...
```
